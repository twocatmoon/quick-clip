import{j,r as p,R as ee,a as te}from"./vendor.a0da257f.js";const oe=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))R(d);new MutationObserver(d=>{for(const u of d)if(u.type==="childList")for(const b of u.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&R(b)}).observe(document,{childList:!0,subtree:!0});function a(d){const u={};return d.integrity&&(u.integrity=d.integrity),d.referrerpolicy&&(u.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?u.credentials="include":d.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function R(d){if(d.ep)return;d.ep=!0;const u=a(d);fetch(d.href,u)}};oe();const o=j.exports.jsx,f=j.exports.jsxs;function re(c){const l=a=>{a[0]>a[1]?a[1]=a[0]:a[1]<a[0]&&(a[0]=a[1]),c.onChange(a)};return f("span",{className:"RangeSlider",children:[o("input",{type:"range",min:c.min,max:c.max,step:c.step||1,value:c.value[0],onChange:a=>l([Number(a.target.value),c.value[1]])}),o("input",{type:"range",min:c.min,max:c.max,step:c.step||1,value:c.value[1],onChange:a=>l([c.value[0],Number(a.target.value)])})]})}const ie="quick-clip",ne="0.1.0",ce={dev:"vite",build:"tsc && vite build --base=/quick-clip/ && touch dist/.nojekyll",preview:"vite preview",deploy:"npm run build && git checkout gh-pages && rm -rf ./assets && rm -f index.html && mv ./dist/* ./ && git add -A && git commit -m 'Deploy' && git push && git checkout trunk"},se={"@ffmpeg/core":"^0.10.0","@ffmpeg/ffmpeg":"^0.10.1","@fortawesome/fontawesome-free":"^6.0.0",react:"^17.0.2","react-dom":"^17.0.2"},ae={"@types/react":"^17.0.33","@types/react-dom":"^17.0.10","@vitejs/plugin-react":"^1.0.7",typescript:"^4.5.4",vite:"^2.8.0"};var de={name:ie,private:!0,version:ne,scripts:ce,dependencies:se,devDependencies:ae};function le(){const c=p.exports.useRef(null),l=p.exports.useRef({crop:{x:0,y:0,width:800,height:600},editorArea:{width:800,height:600},videoWidth:800,videoHeight:800}),[a,R]=p.exports.useState(0),[d,u]=p.exports.useState(!1),b=async()=>{if(!v.current)return;const e=v.current;e&&e.paused?(e.currentTime=g[0]/1e3,await e.play()):e&&e.pause()},[g,$]=p.exports.useState([5,10]),S=e=>{const t=v.current;t&&t.pause(),$(e)},[L,F]=p.exports.useState([0,0]),[k,O]=p.exports.useState([0,0]),H=()=>{const{crop:e,videoWidth:t,videoHeight:i}=l.current,r=v.current.getBoundingClientRect(),m=e.width*(r.width/t),s=e.height*(r.height/i);F([m,s]);const n=e.x*(r.width/t),x=e.y*(r.height/i);O([n,x])},T=()=>{const e=l.current;e.crop.x=e.videoWidth/2-e.crop.width/2,e.crop.y=e.videoHeight/2-e.crop.height/2},D=e=>{const t=l.current;e==="800x600"&&(t.crop.width=800,t.crop.height=600),e==="custom"&&(t.crop.width=Number(prompt("Crop Width (px):"))||800,t.crop.height=Number(prompt("Crop Height (px):"))||600),T(),H()},[N,z]=p.exports.useState(""),P=p.exports.useRef(null),v=p.exports.useRef(null),G=()=>{R(v.current.duration*1e3),$([0,v.current.duration*1e3]),A(!0)},X=e=>{if(e.preventDefault(),!e.dataTransfer.items)return;const t=e.dataTransfer.items[0].getAsFile();P.current=t,z(URL.createObjectURL(t))},V=p.exports.useRef(0);clearInterval(V.current),V.current=setInterval(()=>{if(!v.current)return;const e=v.current,t=document.querySelector("#currentTime");t.innerHTML=`${e.currentTime.toFixed(1)}/${(g[1]/1e3).toFixed(1)}`,!e.paused&&e.currentTime*1e3>=g[1]&&(e.currentTime=g[0]/1e3)},1e3/24);const q=p.exports.useRef({x:0,y:0}),Y=e=>{q.current.x=e.clientX,q.current.y=e.clientY;const i=c.current.querySelector(".VideoContainer").getBoundingClientRect(),h=c.current.querySelector(".VideoCropControl"),r=h.getBoundingClientRect(),m=i.x+(e.clientX-r.x),s=i.y+(e.clientY-r.y),n=C=>{let y=C.clientX-m;y<0&&(y=0),y>i.width-r.width&&(y=i.width-r.width);let w=C.clientY-s;return w<0&&(w=0),w>i.height-r.height&&(w=i.height-r.height),[y,w]},x=C=>{const[y,w]=n(C);h.style.transform=`translate(${y}px, ${w}px)`},I=C=>{const[y,w]=n(C),E=l.current;E.crop.x=y*(E.videoWidth/i.width),E.crop.y=w*(E.videoHeight/i.height),document.removeEventListener("mouseup",I),document.removeEventListener("mousemove",x)};document.addEventListener("mouseup",I),document.addEventListener("mousemove",x)},U=()=>{const e=c.current.querySelector(".VideoEditor");e==null||e.classList.remove("--wide"),e==null||e.classList.add("--tall")},Q=()=>{const e=c.current.querySelector(".VideoEditor");e==null||e.classList.remove("--tall"),e==null||e.classList.add("--wide")},K=()=>{const e=c.current.querySelector(".VideoEditor");e==null||e.classList.remove("--tall"),e==null||e.classList.remove("--wide")},M=p.exports.useRef(0),A=e=>{const t=v.current;!t||(K(),t.pause(),clearTimeout(M.current),M.current=setTimeout(()=>{const i=t.videoHeight/t.videoWidth,r=c.current.querySelector(".VideoEditor").getBoundingClientRect(),m=r.height/r.width,s=l.current;s.editorArea.width=r.width,s.editorArea.height=r.height,s.videoWidth=t.videoWidth,s.videoHeight=t.videoHeight;const n=c.current.querySelector(".VideoContainer");if(i<m)Q(),n.style.width="100%",n.style.height=Math.round(r.width*i)+"px";else{U();const x=t.videoWidth/t.videoHeight;n.style.width=Math.round(r.height*x)+"px",n.style.height="100%"}T(),H()},e?0:200))},B=async e=>{window.focus();try{await navigator.clipboard.writeText(e)}catch(t){console.log(t)}window.focus()},_=e=>{function t(s,n){return n=n||2,("00"+s).slice(-n)}let i=e%1e3;e=(e-i)/1e3;let h=e%60;e=(e-h)/60;let r=e%60,m=(e-r)/60;return t(m)+":"+t(r)+":"+t(h)+"."+t(i,3)},W=()=>{const e="clip",t=P.current.name,i=_(g[0]),h=_(g[1]);let{width:r,height:m,x:s,y:n}=l.current.crop;return s=Math.round(s),s%2===1&&s--,n=Math.round(n),n%2===1&&n--,[t,e,r,m,s,n,i,h]},J=()=>{const[e,t,i,h,r,m,s,n]=W(),x=`ffmpeg -y -i "${e}" -filter:v "crop=${i}:${h}:${r}:${m}" -vcodec libx264 -an -ss ${s} -to ${n} "${t}.mp4"`;B(x),alert("Command copied to clipboard.")},Z=()=>{const[e,t,i,h,r,m,s,n]=W(),x=`ffmpeg -y -i "${e}" -filter:v "crop=${i}:${h}:${r}:${m},fps=24,scale=${Math.round(i/2)}:-1:flags=lanczos,split[s0][s1];[s0]palettegen[p];[s1][p]paletteuse" -loop 0 -an -ss ${s} -to ${n} "${t}.gif"`;B(x),alert("Command copied to clipboard.")};return p.exports.useEffect(()=>{const e=()=>A();return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),f("div",{ref:c,className:"App",onDrop:X,onDragOver:e=>e.preventDefault(),children:[!N&&f("div",{className:"DropTarget",children:[o("p",{children:"Drop Video Here"}),o("p",{children:o("small",{children:"Quick Clip generates FFMPEG CLI commands from a drag-and-drop UI so you can easily crop, trim, and transcode video clips."})}),o("p",{children:f("small",{children:[o("strong",{children:"Quick Clip"})," by ",o("strong",{children:o("a",{href:"https://github.com/twocatmoon",target:"_blank",children:"Two-Cat Moon"})}),o("br",{}),o("a",{href:"https://github.com/twocatmoon/quick-clip",target:"_blank",children:"GitHub"})," \xB7\xA0",o("a",{href:"https://github.com/twocatmoon/quick-clip/issues",target:"_blank",children:"Report Bug"})," \xB7\xA0",o("a",{href:"https://github.com/twocatmoon/quick-clip/issues",target:"_blank",children:"Request Feature"})]})}),o("p",{children:o("small",{children:f("code",{children:["v. ",de.version]})})})]}),N&&f("div",{className:"VideoEditor",children:[o("video",{ref:v,onLoadedData:G,onPause:()=>u(!1),onPlay:()=>u(!0),src:N,muted:!0}),o("div",{className:"VideoContainer",children:o("div",{className:"VideoContainerPanel",children:f("div",{className:"VideoCropControl",style:{width:`${L[0]}px`,height:`${L[1]}px`,transform:`translate(${k[0]}px, ${k[1]}px)`},onMouseDown:Y,children:[f("div",{className:"CropInfo",children:[Math.round(l.current.crop.width),"px x\xA0",Math.round(l.current.crop.height),"px (",o("span",{id:"currentTime",children:"0.0/0.0"}),")"]}),o("div",{className:"Handle__top"}),o("div",{className:"Handle__left"}),o("div",{className:"Handle__bottom"}),o("div",{className:"Handle__right"})]})})}),f("div",{className:"EditorControls",children:[f("div",{className:"EditorControlGroup",children:[o("button",{onClick:b,children:d?"Pause":"Play"}),o(re,{min:0,max:a,step:500,value:g,onChange:S}),o("input",{type:"number",min:0,max:a,step:500,value:g[0],onChange:e=>S([Number(e.target.value),g[1]])}),o("input",{type:"number",min:0,max:a,step:500,value:g[1],onChange:e=>S([g[0],Number(e.target.value)])})]}),f("div",{className:"EditorControlGroup",children:[o("button",{onClick:()=>D("800x600"),children:"800x600"}),o("button",{onClick:()=>D("custom"),children:"Custom"})]}),f("div",{className:"EditorControlGroup",children:[o("button",{className:"--primary",onClick:J,children:"Export .mp4"}),o("button",{className:"--primary",onClick:Z,children:"Export .gif"})]})]})]})]})}ee.render(o(te.StrictMode,{children:o(le,{})}),document.getElementById("root"));
